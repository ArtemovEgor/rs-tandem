# 25 февраля 2026 — Авторизация авторизация авторизация

Во вчерашнем дневнике написал, что закончил роутер и приступаю к авторизации. Оказалось, что согласованная схема работы — авторизация в попапе и отдельные маршруты в роутере под логин и регитрацию — а роутер пока умеет работать только со страницами. Менять ТЗ не хотелось, потому что такие мелочи как отдельные ссылки на вкладки окна авторизации всегда воспринимались как "мелочь, но приятно". Поэтому, пришлось потратить еще немало времени, чтобы прикрутить к роутеру функционал открытия модалки поверх страницы. Самое интересное было учесть случаи вроде перезагрузки страницы или перехода по прямой ссылке.

До этого мой роутер знал, на какой странице находится пользователь и каждый раз при переходе по маршруту полностью перерисовывал контент. Теперь он знает, модалка ли должна открыться. Если открывается модалка, то страница не перерисовывается, а модалка открывается поверх. Еще он запоминает текущую модалку и страницу, поверх которой она открыта. Если пользователь открывает модалку, роутер проверяет, открыта ли какая-то страница. Если да — просто добавляет модалку на нее, а в противном случае отрисовывает предыдущую/дефолтную страницу.

В итоге роутер закончил вчера за несколько часов и надеюсь, что пока этого хватит.

С формой авторизации тоже оказалось немало работы, поэтому сегодня просидел часов 7. За это время сверстал сначала компонент модалки, затем добавил наследующий элемент формы авторизации, который уже, в зависимости от выбора пользователя, показывает форму логина или регистрации. Хоть и заглядывал в код предыдущих проектов, его пришлось значительно улучшить.

Например, в fun-chat не было раздельных авторизации и регистрации, а тут их делать нужно, так как мы с командой решили запрашивать при регистрации имя, чтобы персонализировать приложение, да и вообще такая схема более user-friendly. Пришлось решать задачу о разелении двух _очень_ похожих компонентов, чтобы избежать дублирования кода. Получился один абстрактный класс, который описывает общие части двух разных форм, и имплементации, которые добавляют конкретику.

Плюс оказалось, что в fun-chat я не сильно парился над валидацией полей, и в нее тоже пришлось вносить измнения, чтобы показывать только релевантные каждому полю ошибки, да и вообще правильнее показывать ошибки.

Еще не закончив формы авторизации, я подумал, что их сразу нужно связать с сервисом, который еще не написан, и чуть не бросился его писать. Пришлось бы описать сервис авторизации, а вместе с ним и api-сервис, который умеет работать как с сокетами, так и с mock-backend. К счастью, вовремя остановился и все-таки закончил формы, потому что возвращаться к ним после перерыва было бы сложнее.

Теперь нужно отдохнуть и до конца недели сделать эти сервисы.

Кажется, работа идет неплохо, но сложно понимать, что мы вообще успеем за ближайший месяц. С другой стороны, 2 фичи на каждого у нас точно будут.

Возможно, после всего перечисленного стоит сразу взяться за ai?
